{% extends "base.html" %}

{% block content %}
<div class="container py-5" style="max-width: 700px;">
    <h2 class="mb-4 text-center">{{ _('Configuración del grupo') }}</h2>

    <!-- Contenedor con data-* -->
    <div id="groupSettingsData"
        data-alliances='{{ alliances_serializable | tojson | safe }}'
        data-days='{{ days_serializable | tojson | safe }}'>
    </div>


    <form method="post" action="/groups/update-settings/{{ group.group_code }}" id="settingsForm">
        <!-- Número de alianzas -->
        <div class="mb-4">
            <label for="numAlliances" class="form-label">{{ _('Número de alianzas (1 a 12)') }}</label>
            <select id="numAlliances" name="num_alliances" class="form-select">
                <option value="">{{ _('Selecciona una opción') }}</option>
                {% for i in range(1, 13) %}
                    <option value="{{ i }}">{{ i }}</option>
                {% endfor %}
            </select>
        </div>

        <!-- Campos de nombres de alianzas -->
        <div id="alliancesContainer" class="mb-4"></div>

        <!-- Número de días -->
        <div class="mb-4">
            <label for="numDays" class="form-label">{{ _('Número de días a organizar (1 a 4)') }}</label>
            <select id="numDays" name="num_days" class="form-select">
                <option value="">{{ _('Selecciona una opción') }}</option>
                {% for i in range(1, 5) %}
                    <option value="{{ i }}">{{ i }}</option>
                {% endfor %}
            </select>
        </div>

        <!-- Campos de nombres de días -->
        <div id="daysContainer" class="mb-4"></div>

        <!-- Botones -->
        <div class="text-center d-flex justify-content-center gap-3">
            <button id="confirmButton" type="submit" class="btn btn-primary" disabled>
                {{ _('Guardar cambios') }}
            </button>
            <a href="/groups/view/{{ group.group_code }}" class="btn btn-secondary">
                {{ _('Cancelar') }}
            </a>
        </div>
    </form>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', path='js/codigo.js') }}"></script>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const container = document.getElementById("groupSettingsData");
        const alliancesData = JSON.parse(container.dataset.alliances || "[]");
        const daysData = JSON.parse(container.dataset.days || "[]");

        initGrupoSettingsEdit(alliancesData, daysData);
    });
</script>
{% endblock %}
